<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Age-structured population</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Age-structured population</h1>



<div class="alert alert-info">
<p>If you are unfamiliar with the {simulist} package or the
<code>sim_linelist()</code> function <a href="simulist.html">Get Started
vignette</a> is a great place to start.</p>
</div>
<p>This vignette describes how to simulate a line list with either a
uniform or non-uniform distribution of ages within the population. This
population age structure may either describe the population of a region
as a whole, or specifically which age groups are more likely to become
infected than others.</p>
<p>The {simulist} package uses a branching process (using a random
network model of contacts), which is independent of population age
structure to simulate the line list, and then {simulist} <em>paints</em>
the demographic information onto the infected individuals (and in the
case of <code>sim_outbreak()</code> or <code>sim_contacts()</code> the
contacts of infected individuals). In other words, once the cases in the
line list have been simulated the ages are assigned to each individual
post hoc, specified by the age range, and age structure, if
supplied.</p>
<p>The age range and age structure for the simulation functions
(<code>sim_*()</code>) in {simulist} is controlled by the
<code>population_age</code> argument. The default age structure in
{simulist} is a uniform structure between a lower and upper age range.
The <code>sim_linelist()</code> function (and other <code>sim_*()</code>
functions) can accept a <code>&lt;data.frame&gt;</code> instead of the
<code>numeric</code> vector to specify the age structure for specified
age groups. This feature can be especially useful when wanting to
simulate an outbreak in a region with a heavily non-uniform age
structure, <a href="https://ourworldindata.org/age-structure">for
example younger populations such as Nigeria, or older populations such
as Japan</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(simulist)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(epiparameter)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>First we load the requested delay distributions using the
{epiparameter} package. The onset-to-hospitalisation and onset-to-death
delay distributions are extracted from the {epiparameter} database, and
the contact distribution and the infectious period are manually defined
as they are not yet available from the {epiparameter} database.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>contact_distribution <span class="ot">&lt;-</span> <span class="fu">epiparameter</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">disease =</span> <span class="st">&quot;COVID-19&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">epi_name =</span> <span class="st">&quot;contact distribution&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">prob_distribution =</span> <span class="fu">create_prob_distribution</span>(</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="at">prob_distribution =</span> <span class="st">&quot;pois&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    <span class="at">prob_distribution_params =</span> <span class="fu">c</span>(<span class="at">mean =</span> <span class="dv">2</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  )</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; Citation cannot be created as author, year, journal or title is missing</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>infectious_period <span class="ot">&lt;-</span> <span class="fu">epiparameter</span>(</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="at">disease =</span> <span class="st">&quot;COVID-19&quot;</span>,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="at">epi_name =</span> <span class="st">&quot;infectious period&quot;</span>,</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="at">prob_distribution =</span> <span class="fu">create_prob_distribution</span>(</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="at">prob_distribution =</span> <span class="st">&quot;gamma&quot;</span>,</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="at">prob_distribution_params =</span> <span class="fu">c</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  )</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; Citation cannot be created as author, year, journal or title is missing</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co"># get onset to hospital admission from {epiparameter} database</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>onset_to_hosp <span class="ot">&lt;-</span> <span class="fu">epiparameter_db</span>(</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  <span class="at">disease =</span> <span class="st">&quot;COVID-19&quot;</span>,</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  <span class="at">epi_name =</span> <span class="st">&quot;onset to hospitalisation&quot;</span>,</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  <span class="at">single_epiparameter =</span> <span class="cn">TRUE</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; Using Linton N, Kobayashi T, Yang Y, Hayashi K, Akhmetzhanov A, Jung S, Yuan</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; B, Kinoshita R, Nishiura H (2020). &quot;Incubation Period and Other</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; Epidemiological Characteristics of 2019 Novel Coronavirus Infections</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; with Right Truncation: A Statistical Analysis of Publicly Available</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; Case Data.&quot; _Journal of Clinical Medicine_. doi:10.3390/jcm9020538</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; &lt;https://doi.org/10.3390/jcm9020538&gt;.. </span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="co">#&gt; To retrieve the citation use the &#39;get_citation&#39; function</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co"># get onset to death from {epiparameter} database</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>onset_to_death <span class="ot">&lt;-</span> <span class="fu">epiparameter_db</span>(</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  <span class="at">disease =</span> <span class="st">&quot;COVID-19&quot;</span>,</span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>  <span class="at">epi_name =</span> <span class="st">&quot;onset to death&quot;</span>,</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>  <span class="at">single_epiparameter =</span> <span class="cn">TRUE</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>)</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="co">#&gt; Using Linton N, Kobayashi T, Yang Y, Hayashi K, Akhmetzhanov A, Jung S, Yuan</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="co">#&gt; B, Kinoshita R, Nishiura H (2020). &quot;Incubation Period and Other</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="co">#&gt; Epidemiological Characteristics of 2019 Novel Coronavirus Infections</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="co">#&gt; with Right Truncation: A Statistical Analysis of Publicly Available</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a><span class="co">#&gt; Case Data.&quot; _Journal of Clinical Medicine_. doi:10.3390/jcm9020538</span></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="co">#&gt; &lt;https://doi.org/10.3390/jcm9020538&gt;.. </span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a><span class="co">#&gt; To retrieve the citation use the &#39;get_citation&#39; function</span></span></code></pre></div>
<p>By setting the seed we ensure the output of the vignette remains the
same each time it is rendered. When using {simulist}, setting the seed
is not required unless you need to simulate the same line list multiple
times.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span></code></pre></div>
<div id="uniform-population-age" class="section level2">
<h2>Uniform population age</h2>
<p>By default <code>sim_linelist()</code> simulates individuals ages
assuming a uniform distribution between 1 and 90. To change this age
range, a vector of two numbers can be supplied to the
<code>population_age</code> argument. Here we simulate an outbreak in a
population with a population ranging from 5 to 75 (inclusive,
<code>[5,75]</code>).</p>
<p><strong><em>Note</em></strong>: all ages are assumed to be in the
unit of years and need to be integers (or at least <a href="https://rlang.r-lib.org/reference/is_integerish.html">“integerish”</a>
if stored as double).</p>
<p>All simulations in this vignette condition the simulation to have a
minimum outbreak size of 100 cases (<code>outbreak_size</code>, the
maximum outbreak size is left at <code>1e4</code>) to clearly visualise
the distribution of ages.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">sim_linelist</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">contact_distribution =</span> contact_distribution,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">infectious_period =</span> infectious_period,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">prob_infection =</span> <span class="fl">0.45</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">onset_to_hosp =</span> onset_to_hosp,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">onset_to_death =</span> onset_to_death,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">population_age =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">75</span>),</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">outbreak_size =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e4</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">head</span>(linelist)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;   id         case_name case_type sex age date_onset date_reporting</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 1  1     Kendra Haider  probable   f  56 2023-01-01     2023-01-01</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 2  2 Cante Truefeather suspected   f   7 2023-01-01     2023-01-01</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 3  3      K&#39;Ara Fisher suspected   f  15 2023-01-01     2023-01-01</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 4  5   Raymond Qureshi  probable   m  60 2023-01-02     2023-01-02</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 5  6   Keshaun Bennett suspected   m  57 2023-01-02     2023-01-02</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 6  8       Faline Thao confirmed   f  38 2023-01-01     2023-01-01</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; 2           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-30        2023-01-05</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; 3     2023-01-05      died   2023-01-08         2022-12-29        2023-01-06</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; 4           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-30        2023-01-03</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-26        2023-01-03</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; 6           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-28        2023-01-02</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;   ct_value</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; 1       NA</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; 2       NA</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 3       NA</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; 4       NA</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; 5       NA</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; 6     23.7</span></span></code></pre></div>
<p>We can plot the age distribution for individuals in the line list,
binned into 5 year categories.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(linelist[, <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>)]) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#10BED2&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">5</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Number of Individuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">75</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>&lt;img
src=“/tmp/RtmpbTSW6h/Rbuild1864d1f2d4375/simulist/vignettes/age-struct-pop_files/figure-html/plot-age-range-1.png”
alt=“A histogram for the age distribution of individuals in a simulated
line list sampled from a uniform distribution between 5 and 75. Ages are
binned into 5 year age groups. There is a small amount of variation in
counts of individuals in each group. The y-axis is labelled”Number of
Individuals”, and the x-axis is labelled “Age”.” /&gt;</p>
<p>If the <code>population_age</code> argument was left unspecified, it
would have assumed the default age range of 1 to 90
(<code>c(1, 90)</code>).</p>
</div>
<div id="structured-population-age" class="section level2">
<h2>Structured population age</h2>
<p>To simulate with a non-uniform age structure we create a table
(<code>&lt;data.frame&gt;</code>) containing the age bounds of each age
bracket in the population and the proportion of the population made up
by that age group.</p>
<div class="alert alert-warning">
<p>The upper bound (maximum) of the population also needs to be
specified in the age structure <code>&lt;data.frame&gt;</code>,
therefore, the last element in the age limits column is taken as the
upper bound of the age in the population. All elements before the last
one are the lower bound of each age group.</p>
<p>The simplest way to set the maximum population age is to set the
proportion to zero.</p>
</div>
<p>For this example we will simulate a population where 30% of the
population are between 1 and 19, 40% of the population are between 20
and 59, and 30% are between 60 and 89. The age limits
(<code>$age_limit</code> column) is inclusive. There will be no
individuals in the population younger then 1 or older than 90.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>age_struct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">age_limit =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">60</span>, <span class="dv">90</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="dv">0</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>age_struct</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;   age_limit proportion</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 1         1        0.3</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; 2        20        0.4</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; 3        60        0.3</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; 4        90        0.0</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">sim_linelist</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">contact_distribution =</span> contact_distribution,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">infectious_period =</span> infectious_period,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">prob_infection =</span> <span class="fl">0.45</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">onset_to_hosp =</span> onset_to_hosp,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="at">onset_to_death =</span> onset_to_death,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="at">population_age =</span> age_struct,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="at">outbreak_size =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e4</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">head</span>(linelist)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;   id        case_name case_type sex age date_onset date_reporting</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; 1  1 Daniel Hernandez suspected   m  22 2023-01-01     2023-01-01</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; 2  3 Shaamil el-Qasim suspected   m  26 2023-01-01     2023-01-01</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; 3  4     Omar Peinado  probable   m  59 2023-01-01     2023-01-01</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 4  6      Jason Sinka confirmed   m  60 2023-01-01     2023-01-01</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; 5  7  Mariah Martinez confirmed   f  72 2023-01-01     2023-01-01</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; 6  8  Joseline Bobian confirmed   f  16 2023-01-01     2023-01-01</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; 2           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-29        2023-01-05</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; 3           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-31        2023-01-02</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 4           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-30        2023-01-03</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-27        2023-01-03</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; 6     2023-01-04      died   2023-01-07         2023-01-01        2023-01-03</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt;   ct_value</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; 1       NA</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; 2       NA</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; 3       NA</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; 4     26.3</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; 5     25.8</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; 6     24.6</span></span></code></pre></div>
<p>Again we can plot the age distribution to see the age structure for
individuals in the line list. Given the relative uniformity of the age
structure specified it is not greatly different from the uniform age
structure plotted above, other than having a higher upper age limit. The
data is binned into 5 year categories and facetted by sex.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(linelist[, <span class="fu">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;age&quot;</span>)]) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> age),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;#10BED2&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="at">binwidth =</span> <span class="dv">5</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Number of Individuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Age&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">90</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(sex))</span></code></pre></div>
<p>&lt;img
src=“/tmp/RtmpbTSW6h/Rbuild1864d1f2d4375/simulist/vignettes/age-struct-pop_files/figure-html/plot-age-struct-1.png”
alt=“Two histograms, facetted by sex, for the age distribution of
individuals in a simulated line list sampled from an age-structured
population defined in the data.frame above. Ages are binned into 5 year
age groups. There is variation in counts of individuals in each group,
and the histograms between male (m) and female (f) are similar. The
y-axis is labelled”Number of Individuals”, and the x-axis is labelled
“Age”.” /&gt;</p>
<p>An example for a much younger population could instead specify:</p>
<ul>
<li><code>0.4</code> (or 40%) for 1-9 years old</li>
<li><code>0.3</code> (or 30%) for 10-29 years old</li>
<li><code>0.2</code> (or 20%) for 30-59 years old</li>
<li><code>0.1</code> (or 10%) for 60-75 years old</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>age_struct <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="at">age_limit =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">75</span>),</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="at">proportion =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="dv">0</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>age_struct</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;   age_limit proportion</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 1         1        0.4</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 2        10        0.3</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; 3        30        0.2</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; 4        60        0.1</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; 5        75        0.0</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>linelist <span class="ot">&lt;-</span> <span class="fu">sim_linelist</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">contact_distribution =</span> contact_distribution,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">infectious_period =</span> infectious_period,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">prob_infection =</span> <span class="fl">0.45</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">onset_to_hosp =</span> onset_to_hosp,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">onset_to_death =</span> onset_to_death,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">population_age =</span> age_struct,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">outbreak_size =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e4</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="fu">head</span>(linelist)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;   id             case_name case_type sex age date_onset date_reporting</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 1  1         Tanner Latham confirmed   m  17 2023-01-01     2023-01-01</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 2  2        Derrick Mishra  probable   m  53 2023-01-01     2023-01-01</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; 3  4     Saabiqa al-Haidar confirmed   f  20 2023-01-01     2023-01-01</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; 4  5 Antione Malone-Rogers suspected   m   6 2023-01-01     2023-01-01</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; 5  6         Ariel Ramirez  probable   f  14 2023-01-04     2023-01-04</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 6  8     Brendan Van Eaton suspected   m  60 2023-01-01     2023-01-01</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt;   date_admission   outcome date_outcome date_first_contact date_last_contact</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; 1           &lt;NA&gt; recovered         &lt;NA&gt;               &lt;NA&gt;              &lt;NA&gt;</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; 2           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-29        2023-01-03</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; 3           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-27        2023-01-02</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; 4     2023-01-03      died   2023-01-12         2022-12-29        2023-01-05</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt; 5           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-28        2023-01-04</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; 6           &lt;NA&gt; recovered         &lt;NA&gt;         2022-12-29        2023-01-08</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt;   ct_value</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; 1     26.7</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; 2       NA</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; 3     21.8</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; 4       NA</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; 5       NA</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt; 6       NA</span></span></code></pre></div>
<p>A common and useful method for plotting age data is in the form of
age pyramids. Here we partition the data by sex and plot the age
distribution.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>linelist_m <span class="ot">&lt;-</span> <span class="fu">subset</span>(linelist, <span class="at">subset =</span> sex <span class="sc">==</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>age_cats_m <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">floor</span>(linelist_m<span class="sc">$</span>age <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>))</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">colnames</span>(age_cats_m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AgeCat&quot;</span>, <span class="st">&quot;Population&quot;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>age_cats_m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(age_cats_m, <span class="at">sex =</span> <span class="st">&quot;m&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>linelist_f <span class="ot">&lt;-</span> <span class="fu">subset</span>(linelist, <span class="at">subset =</span> sex <span class="sc">==</span> <span class="st">&quot;f&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>age_cats_f <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(<span class="fu">floor</span>(linelist_f<span class="sc">$</span>age <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">colnames</span>(age_cats_f) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AgeCat&quot;</span>, <span class="st">&quot;Population&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>age_cats_f<span class="sc">$</span>Population <span class="ot">&lt;-</span> <span class="sc">-</span>age_cats_f<span class="sc">$</span>Population</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>age_cats_f <span class="ot">&lt;-</span> <span class="fu">cbind</span>(age_cats_f, <span class="at">sex =</span> <span class="st">&quot;f&quot;</span>)</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>age_cats <span class="ot">&lt;-</span> <span class="fu">rbind</span>(age_cats_m, age_cats_f)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="fu">range</span>(age_cats<span class="sc">$</span>Population), <span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">abs</span>(breaks)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(age_cats) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Population, <span class="at">y =</span> <span class="fu">factor</span>(AgeCat), <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Lower bound of Age Category&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Population&quot;</span>, <span class="at">breaks =</span> breaks, <span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#F04A4C&quot;</span>, <span class="st">&quot;#106BA0&quot;</span>)) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>&lt;img
src=“/tmp/RtmpbTSW6h/Rbuild1864d1f2d4375/simulist/vignettes/age-struct-pop_files/figure-html/plot-age-struct-young-1.png”
alt=“An age pyramid for a simulated line list with an age-structured
population. The y-axis is labeled”Lower bound of Age Category”, the
x-axis is labelled “Population”. The left of the age pyramid plots the
number of female individuals (red) in each age category and the right of
the age pyramid plots the number of male individuals (blue) in each age
category. The age pyramid shows many young people in the population,
aged below 10, and relatively fewer older individuals. The pattern
between male and female is similar.” /&gt;</p>
<p>We have used the {ggplot2} package to construct our age pyramid,
however the <a href="https://r4epi.github.io/apyramid/">{apyramid} R
package from R4Epi</a> can assist in making these plots; as can the <a href="https://www.epirhandbook.com/en/new_pages/age_pyramid.html">Applied
Epidemiology Handbook chapter on age pyramids</a>. The blog post on <a href="https://www.njtierney.com/post/2022/08/09/ggplot-pyramid/">“Population
Pyramid Plots in ggplot2”</a> also contains useful tips on constructing
pyramid plots.</p>
<p>As shown in the two age-structured examples, the number of age groups
is flexible. Therefore a coarse population structure with two or three
age groups can be specified, or where precise census demographic data is
available, several age groups can be specified.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
